(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{440:function(t,e,i){"use strict";i.r(e);var s=i(44),a=Object(s.a)({},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[i("h1",{attrs:{id:"万一-github不让用了-gitee同步指南请收好"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#万一-github不让用了-gitee同步指南请收好"}},[t._v("#")]),t._v(" 万一 Github不让用了，Gitee同步指南请收好")]),t._v(" "),i("p",[t._v("大家好，我是秋风，最近很多开源项目让一个本该纯粹的地方混入了政治色彩。例如 Node 还有 React 这些超明星级的项目。")]),t._v(" "),i("p",[i("img",{attrs:{src:"https://s3.qiufeng.blue/blog/gitee-image.png?imageView2/0/q/75",alt:""}})]),t._v(" "),i("p",[i("img",{attrs:{src:"https://s3.qiufeng.blue/blog/gitee-image_1.png?imageView2/0/q/75",alt:""}})]),t._v(" "),i("p",[t._v("目前来看 React 的issues 已经沦陷了，大家都在反对一个原本纯粹的地方为什么会有了政治？")]),t._v(" "),i("p",[i("img",{attrs:{src:"https://s3.qiufeng.blue/blog/gitee-image_2.png?imageView2/0/q/75",alt:""}})]),t._v(" "),i("p",[t._v("如果说开源项目涉及了政治，那么github 还会远吗，我不得而知。为了避免造成不必要的损失，因此连夜把自己github 上的项目都同步一份到了 gitee，并且写下了这一份指南。")]),t._v(" "),i("p",[i("img",{attrs:{src:"https://s3.qiufeng.blue/blog/gitee-image_3.png?imageView2/0/q/75",alt:""}})]),t._v(" "),i("p",[t._v("因此我也建议大家未雨绸缪，对自己的github账户进行备份，不管一切，不能让我们本应该有的权益受到损失。")]),t._v(" "),i("p",[t._v("同步主要分为"),i("strong",[t._v("现有仓库同步")]),t._v("以及"),i("strong",[t._v("未来代码同步")]),t._v("两个部分。")]),t._v(" "),i("h2",{attrs:{id:"现有仓库同步"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#现有仓库同步"}},[t._v("#")]),t._v(" 现有仓库同步")]),t._v(" "),i("p",[t._v("这一步其实 gitee 官网已经集成了一键导入的功能。")]),t._v(" "),i("p",[t._v("详情："),i("a",{attrs:{href:"https://gitee.com/help/articles/4284",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://gitee.com/help/articles/4284"),i("OutboundLink")],1)]),t._v(" "),i("p",[t._v("一共分为3个步骤：")]),t._v(" "),i("p",[t._v("1.从 + 号找到 从 Github/Gitlab导入仓库")]),t._v(" "),i("p",[i("img",{attrs:{src:"https://s3.qiufeng.blue/blog/gitee-image_4.png?imageView2/0/q/75",alt:""}})]),t._v(" "),i("p",[t._v("2.授权 gitee github 权限")]),t._v(" "),i("p",[i("img",{attrs:{src:"https://s3.qiufeng.blue/blog/gitee-image_5.png?imageView2/0/q/75",alt:""}})]),t._v(" "),i("p",[t._v("3.授权后可以看到这样一个 tab 页面选项，我们选择 导入当前页面所有仓库")]),t._v(" "),i("p",[i("img",{attrs:{src:"https://s3.qiufeng.blue/blog/gitee-image_6.png?imageView2/0/q/75",alt:""}})]),t._v(" "),i("p",[t._v("gitee 就会自动帮我们导入在 github 的项目，等待一些时间就好。")]),t._v(" "),i("p",[i("img",{attrs:{src:"image/gitee-image_7.png",alt:""}})]),t._v(" "),i("p",[t._v("导入完成之后，所有的项目都是私有权限，因此也不用担心自己原本在 gihtub 上的私有仓库权限泄漏。")]),t._v(" "),i("p",[i("img",{attrs:{src:"https://s3.qiufeng.blue/blog/gitee-image_8.png?imageView2/0/q/75",alt:""}})]),t._v(" "),i("h2",{attrs:{id:"未来代码的同步"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#未来代码的同步"}},[t._v("#")]),t._v(" 未来代码的同步")]),t._v(" "),i("p",[t._v("虽然我们已经把现有的仓库全部同步到了gitee ，但是我们本地仓库的源还是 github 的，因此还需要对这部分未来增量代码做处理。")]),t._v(" "),i("h3",{attrs:{id:"方案一-增加-remote-源"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#方案一-增加-remote-源"}},[t._v("#")]),t._v(" 方案一：增加 remote 源")]),t._v(" "),i("p",[t._v("这个方案其实很简单，很多同学在提交开源项目，想要合入开源项目最新代码的时候肯定用到过。")]),t._v(" "),i("p",[i("code",[t._v("git remote add <name> <url>")])]),t._v(" "),i("p",[t._v("一共分为 2个步骤：")]),t._v(" "),i("p",[t._v("1.在你原来的 github 仓库下添加远端仓库")]),t._v(" "),i("p",[t._v("例如："),i("code",[t._v("git remote add gitee ``[git@github.com](mailto:git@github.com)``:hua1995116/mmt.git")])]),t._v(" "),i("p",[t._v("添加后可以看到这样的：")]),t._v(" "),i("p",[i("img",{attrs:{src:"https://s3.qiufeng.blue/blog/gitee-image_9.png?imageView2/0/q/75",alt:""}})]),t._v(" "),i("p",[t._v("2.提交当前的增量代码")]),t._v(" "),i("div",{staticClass:"language-纯文本 extra-class"},[i("pre",{pre:!0,attrs:{class:"language-text"}},[i("code",[t._v("git push origin   // 提交到 github\ngit push gitee    // 提交到 gitee\n")])])]),i("p",[t._v("而这种方式有一个缺点就是每次需要提交两次。")]),t._v(" "),i("h3",{attrs:{id:"方案二-增加-push-源"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#方案二-增加-push-源"}},[t._v("#")]),t._v(" 方案二：增加 push 源")]),t._v(" "),i("p",[t._v("1.删除方法一的 gitee 源 (还没有操作方案一的忽略这个步骤)")]),t._v(" "),i("div",{staticClass:"language-纯文本 extra-class"},[i("pre",{pre:!0,attrs:{class:"language-text"}},[i("code",[t._v("git remote rm gitee\n")])])]),i("p",[t._v("2.添加 push 源")]),t._v(" "),i("div",{staticClass:"language-纯文本 extra-class"},[i("pre",{pre:!0,attrs:{class:"language-text"}},[i("code",[t._v("git remote set-url --add origin git@github.com:hua1995116/mmt.git\n")])])]),i("p",[t._v("3.提交代码")]),t._v(" "),i("div",{staticClass:"language-纯文本 extra-class"},[i("pre",{pre:!0,attrs:{class:"language-text"}},[i("code",[t._v("git push origin\n")])])]),i("p",[t._v("为了省去第二步繁琐，我配置了一个脚本能够快速添加。（"),i("strong",[t._v("前提是你的gihtub 账户名字和 gitee 的账户名字是一样的")]),t._v("）")]),t._v(" "),i("div",{staticClass:"language-纯文本 extra-class"},[i("pre",{pre:!0,attrs:{class:"language-text"}},[i("code",[t._v("npm i -g mmt\nmmt import https://gitee.com/hua1995116/mmt-practices/raw/master/mmt-export-gitee.json\n// 进入到你想要添加命令的目录\nmmt run gitee // 每个原有 github 仓库无脑运行这个命令就可以\n")])])]),i("p",[t._v("效果：")]),t._v(" "),i("p",[i("img",{attrs:{src:"https://s3.qiufeng.blue/blog/gitee-image_10.png?imageView2/0/q/75",alt:""}})]),t._v(" "),i("h3",{attrs:{id:"方案三-使用github-action"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#方案三-使用github-action"}},[t._v("#")]),t._v(" 方案三: 使用github action")]),t._v(" "),i("p",[t._v("此方案一共两个步骤")]),t._v(" "),i("p",[t._v("1.在仓库根目录创建 .github/workflows 目录")]),t._v(" "),i("p",[t._v("2.创建 gitee-sync.yml")]),t._v(" "),i("div",{staticClass:"language-纯文本 extra-class"},[i("pre",{pre:!0,attrs:{class:"language-text"}},[i("code",[t._v("# 通过 Github actions， 在 Github 仓库的每一次 commit 后自动同步到 Gitee 上\nname: gitee-sync\non:\n  push:\n    branches:\n      - master\njobs:\n  repo-sync:\n    env:\n      dst_key: ${{ secrets.GITEE_PRIVATE_KEY }}\n      dst_token: ${{ secrets.GITEE_TOKEN }}\n      gitee_user: ${{ secrets.GITEE_USER }}\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v2\n        with:\n          persist-credentials: false\n\n      - name: sync github -> gitee\n        uses: Yikun/hub-mirror-action@master\n        if: env.dst_key && env.dst_token && env.gitee_user\n        with:\n          # 必选，需要同步的 Github 用户（源）\n          src: 'github/${{ github.repository_owner }}'\n          # 必选，需要同步到的 Gitee 用户（目的）\n          dst: 'gitee/${{ secrets.GITEE_USER }}'\n          # 必选，Gitee公钥对应的私钥，https://gitee.com/profile/sshkeys\n          dst_key: ${{ secrets.GITEE_PRIVATE_KEY }}\n          # 必选，Gitee对应的用于创建仓库的token，https://gitee.com/profile/personal_access_tokens\n          dst_token:  ${{ secrets.GITEE_TOKEN }}\n          # 如果是组织，指定组织即可，默认为用户 user\n          # account_type: org\n          # 直接取当前项目的仓库名\n          static_list: ${{ github.event.repository.name }}\n          # 还有黑、白名单，静态名单机制，可以用于更新某些指定库\n          # static_list: 'repo_name,repo_name2'\n          # black_list: 'repo_name,repo_name2'\n          # white_list: 'repo_name,repo_name2'\n")])])]),i("p",[t._v("3.在 Github 需要同步的仓库上添加 3 个 secrets: (Setting -> Secrets -> New repository secret)")]),t._v(" "),i("ul",[i("li",[t._v("GITEE_USER, 例如我的 gitee "),i("code",[t._v("hua1995116")])]),t._v(" "),i("li",[i("code",[t._v("GITEE_PRIVATE_KEY")]),t._v("，获取方法(如果已有，直接设置) - "),i("a",{attrs:{href:"https://gitee.com/profile/sshkeys",target:"_blank",rel:"noopener noreferrer"}},[t._v("Gitee公钥对应的私钥"),i("OutboundLink")],1),t._v(" "),i("ul",[i("li",[t._v("新建 private key 方法：")]),t._v(" "),i("li",[i("a",{attrs:{href:"https://gitee.com/help/articles/4181#article-header0",target:"_blank",rel:"noopener noreferrer"}},[t._v("生成 SSH 公钥"),i("OutboundLink")],1)]),t._v(" "),i("li",[i("a",{attrs:{href:"https://gitee.com/profile/sshkeys",target:"_blank",rel:"noopener noreferrer"}},[t._v("将 SSH 公钥添加到 Gitee 公钥"),i("OutboundLink")],1)]),t._v(" "),i("li",[t._v("同时将公钥添加到 Github 项目的 secrets 中;")])])]),t._v(" "),i("li",[i("code",[t._v("GITEE_TOKEN")]),t._v("，获取方法 - "),i("a",{attrs:{href:"https://gitee.com/profile/personal_access_tokens",target:"_blank",rel:"noopener noreferrer"}},[t._v("Gitee对应的用于创建仓库的token"),i("OutboundLink")],1),t._v("\n新建 token 方法：\n"),i("ul",[i("li",[t._v("点击上面的链接并登录 Gitee, 点击“生成新令牌”，")]),t._v(" "),i("li",[t._v("添加描述，比如用处 - Github 仓库同步到 Gitee；")]),t._v(" "),i("li",[t._v("权限默认全选，点击提交，显示出生成的 token 值；（注意保存，需要填到 Github 的 secrets 中）")])])])]),t._v(" "),i("p",[t._v("最后后续所有提交，可以利用 github action 自动同步。")]),t._v(" "),i("table",[i("thead",[i("tr",[i("th"),t._v(" "),i("th",[t._v("方案一")]),t._v(" "),i("th",[t._v("方案二")]),t._v(" "),i("th",[t._v("方案三")])])]),t._v(" "),i("tbody",[i("tr",[i("td",[t._v("优点")]),t._v(" "),i("td",[t._v("1.配置简单"),i("br"),t._v("2.能够控制提交源")]),t._v(" "),i("td",[t._v("1.配置简单"),i("br"),t._v("2.提交简单")]),t._v(" "),i("td",[t._v("1.配置繁琐"),i("br"),t._v("2.提交和原来无异")])]),t._v(" "),i("tr",[i("td",[t._v("缺点")]),t._v(" "),i("td",[t._v("需要提交两次")]),t._v(" "),i("td",[t._v("无法控制")]),t._v(" "),i("td",[t._v("github action 被制裁了就gg")])]),t._v(" "),i("tr",[i("td",[t._v("评星")]),t._v(" "),i("td",[t._v("⭐️⭐️⭐️")]),t._v(" "),i("td",[t._v("⭐️⭐️⭐️⭐️⭐️")]),t._v(" "),i("td",[t._v("⭐️⭐️⭐️")])])])]),t._v(" "),i("p",[t._v("在我写完本文的时候事情也有了一些发酵，我看到 3-2 的时候github 发布了声明依旧会无国界地提供服务。")]),t._v(" "),i("p",[i("img",{attrs:{src:"https://s3.qiufeng.blue/blog/gitee-image_11.png?imageView2/0/q/75",alt:""}})]),t._v(" "),i("p",[i("a",{attrs:{href:"https://github.blog/2022-03-02-our-response-to-the-war-in-ukraine/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.blog/2022-03-02-our-response-to-the-war-in-ukraine/"),i("OutboundLink")],1)]),t._v(" "),i("p",[t._v("但是在这次事件还有人被封了号")]),t._v(" "),i("p",[i("img",{attrs:{src:"https://s3.qiufeng.blue/blog/gitee-image_12.png?imageView2/0/q/75",alt:""}})]),t._v(" "),i("p",[t._v("所以，")]),t._v(" "),i("p",[t._v("备份数据很重要！")]),t._v(" "),i("p",[t._v("备份数据很重要！")]),t._v(" "),i("p",[t._v("备份数据很重要！")]),t._v(" "),i("p",[t._v("明天和意外哪个会先降临我们不知道，但是我们要做的尽可能的未雨绸缪！")]),t._v(" "),i("p",[t._v("最后感谢你的阅读，请转给需要的人。")])])}),[],!1,null,null,null);e.default=a.exports}}]);