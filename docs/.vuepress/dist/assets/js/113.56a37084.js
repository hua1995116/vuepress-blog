(window.webpackJsonp=window.webpackJsonp||[]).push([[113],{501:function(t,e,o){"use strict";o.r(e);var v=o(44),r=Object(v.a)({},(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[o("h1",{attrs:{id:"react-hooksä¸­è¿™æ ·å†™httpè¯·æ±‚å¯ä»¥é¿å…å†…å­˜æ³„æ¼"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#react-hooksä¸­è¿™æ ·å†™httpè¯·æ±‚å¯ä»¥é¿å…å†…å­˜æ³„æ¼"}},[t._v("#")]),t._v(" React Hooksä¸­è¿™æ ·å†™HTTPè¯·æ±‚å¯ä»¥é¿å…å†…å­˜æ³„æ¼")]),t._v(" "),o("blockquote",[o("p",[t._v("è¯‘æ–‡æ¥è‡ª https://dev.to/somedood/best-practices-for-es2017-asynchronous-functions-async-await-39ji")]),t._v(" "),o("p",[t._v("åŸä½œè€… Victor de la FouchardiÃ¨re")]),t._v(" "),o("p",[t._v("è¯‘è€…: è“è‰²çš„ç§‹é£(github/hua1995116)")])]),t._v(" "),o("p",[t._v("å¤§å®¶å¥½ ï¼ ğŸ‘‹")]),t._v(" "),o("p",[t._v("ä»Šå¤©ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹åœ¨ React Hooks ä¸­ä½¿ç”¨ "),o("code",[t._v("fetch")]),t._v(" å’Œ"),o("code",[t._v("Abort Controller")]),t._v("å–æ¶ˆWebè¯·æ±‚ä»è€Œæ¥é¿å…å†…å­˜æ³„éœ²ï¼ ğŸ¤—")]),t._v(" "),o("p",[t._v("å½“æˆ‘ä»¬ç”¨ Fetch æ¥ç®¡ç†æ•°æ®æ—¶ï¼Œæœ‰æ—¶æˆ‘ä»¬æƒ³å–æ¶ˆè¯·æ±‚ï¼ˆä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬ç¦»å¼€å½“å‰é¡µé¢æ—¶ï¼Œå½“æˆ‘ä»¬å…³é—­æ¨¡æ€æ¡†ï¼Œ...ï¼‰ã€‚")]),t._v(" "),o("p",[t._v("åœ¨ğŸ‘‡ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬è¦åœ¨åˆ‡æ¢è·¯ç”±çš„æ—¶å€™è·å–å¹¶å±•ç¤ºæ•°æ®ã€‚ ä½†æ˜¯ï¼Œæˆ‘ä»¬åœ¨è·å–æ•°æ®å®Œæ¯•ä¹‹å‰å°±ç¦»å¼€äº†è·¯ç”±/é¡µé¢ã€‚")]),t._v(" "),o("p",[o("img",{attrs:{src:"https://s3.qiufeng.blue/blog/7p2coedr8hhtdltuzxu1.gif",alt:"7p2coedr8hhtdltuzxu1"}})]),t._v(" "),o("p",[o("img",{attrs:{src:"https://s3.qiufeng.blue/blog/4uoij0o2qmdlppeykeln.png",alt:"4uoij0o2qmdlppeykeln"}})]),t._v(" "),o("p",[t._v("æˆ‘ä»¬åˆšåˆšçœ‹åˆ°äº†ä¸€ä¸ª"),o("strong",[t._v("å†…å­˜æ³„æ¼")]),t._v("!è®©æˆ‘ä»¬çœ‹çœ‹ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ä¸ªé”™è¯¯ï¼Œä»¥åŠå®ƒçš„å…·ä½“å«ä¹‰ã€‚")]),t._v(" "),o("p",[o("strong",[t._v("â“ä¸ºä»€ä¹ˆæœ‰å†…å­˜æ³„æ¼ï¼Ÿ")]),t._v("ï¼šæˆ‘ä»¬æœ‰ä¸€ä¸ªæ‰§è¡Œå¼‚æ­¥"),o("code",[t._v("fetch(url)")]),t._v("ä»»åŠ¡çš„ç»„ä»¶ï¼Œç„¶åæ›´æ–°è¯¥ç»„ä»¶çš„çŠ¶æ€æ¥æ˜¾ç¤ºå…ƒç´ ï¼Œ"),o("strong",[t._v("ä½†æ˜¯")]),t._v("æˆ‘ä»¬åœ¨è¯·æ±‚å®Œæˆä¹‹å‰å°±å¸è½½(unmounted)äº†è¯¥ç»„ä»¶ã€‚ ç”±äºå·²å¸è½½ç»„ä»¶çš„çŠ¶æ€ï¼ˆä¾‹å¦‚ "),o("code",[t._v("setUsers")]),t._v("ï¼Œ"),o("code",[t._v("setState")]),t._v("ï¼‰è¢«æ›´æ–°, æ‰€ä»¥é€ æˆäº†æ­¤æ¬¡"),o("strong",[t._v("å†…å­˜æ³„éœ²")]),t._v("ã€‚")]),t._v(" "),o("h2",{attrs:{id:"ğŸš€è®©æˆ‘ä»¬ä½¿ç”¨æ–°çš„-abortcontroller-api"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#ğŸš€è®©æˆ‘ä»¬ä½¿ç”¨æ–°çš„-abortcontroller-api"}},[t._v("#")]),t._v(" ğŸš€è®©æˆ‘ä»¬ä½¿ç”¨æ–°çš„ AbortController APIï¼")]),t._v(" "),o("p",[o("strong",[t._v("Abort Controller")]),t._v(" å…è®¸æ‚¨è®¢é˜…ä¸€ä¸ªæˆ–å¤šä¸ªWebè¯·æ±‚ï¼Œå¹¶å…·æœ‰å–æ¶ˆè¯·æ±‚çš„èƒ½åŠ›ã€‚ ğŸ”¥")]),t._v(" "),o("p",[o("img",{attrs:{src:"https://s3.qiufeng.blue/blog/fvipu2xkelip28hcfoqp.png",alt:"fvipu2xkelip28hcfoqp"}})]),t._v(" "),o("p",[t._v("ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®"),o("code",[t._v("controller.signal")]),t._v("ã€‚")]),t._v(" "),o("blockquote",[o("p",[t._v("â€œ å…·æœ‰ "),o("code",[t._v("read-only")]),t._v("å±æ€§çš„ "),o("code",[t._v("AbortController")]),t._v("æ¥å£è¿”å›ä¸€ä¸ª"),o("code",[t._v("AbortSignal")]),t._v(" (https://developer.mozilla.org/en-US/docs/Web/API/AbortSignal) å¯¹è±¡å®ä¾‹ï¼Œè¯¥å®ä¾‹å¯ç”¨äºæ ¹æ®éœ€è¦ä¸DOMè¯·æ±‚é€šä¿¡/ä¸­æ­¢å®ƒã€‚â€   æ¥è‡ªMDNï¼ˆhttps://developer.mozilla.org/en-US/docs/Web/API/AbortControllerï¼‰")])]),t._v(" "),o("p",[t._v("è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨å®ƒğŸ’ª")]),t._v(" "),o("p",[o("img",{attrs:{src:"https://s3.qiufeng.blue/blog/vlvi82bo5lk2nopqzn8z.png",alt:"vlvi82bo5lk2nopqzn8z"}})]),t._v(" "),o("p",[t._v("æœ€åï¼Œå¦‚æœæˆ‘ä»¬æƒ³å–æ¶ˆå½“å‰è¯·æ±‚ï¼Œåªéœ€è°ƒç”¨"),o("code",[t._v("abort()")]),t._v("ã€‚ å¦å¤–ï¼Œä½ å¯ä»¥è·å–"),o("code",[t._v("controller.signal.aborted")]),t._v("ï¼Œå®ƒæ˜¯ä¸€ä¸ªåªè¯»å±æ€§ï¼Œå®ƒè¿”å›ä¸€ä¸ª"),o("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Boolean",target:"_blank",rel:"noopener noreferrer"}},[o("code",[t._v("Boolean")]),o("OutboundLink")],1),t._v("è¡¨ç¤ºä¸DOMé€šè®¯çš„ä¿¡å·æ˜¯("),o("code",[t._v("true")]),t._v(")å¦("),o("code",[t._v("false")]),t._v(")å·²è¢«æ”¾å¼ƒã€‚")]),t._v(" "),o("p",[o("img",{attrs:{src:"https://s3.qiufeng.blue/blog/yswm5mktqv16v0tiio9e.png",alt:"yswm5mktqv16v0tiio9e"}})]),t._v(" "),o("blockquote",[o("p",[t._v("â—ï¸æ³¨æ„ï¼šè°ƒç”¨"),o("code",[t._v("abort()")]),t._v("æ—¶ï¼Œ"),o("code",[t._v("fetch()")]),t._v(" promise ä¼šä»¥åä¸ºAbortError çš„ DOMException rejectã€‚")])]),t._v(" "),o("p",[t._v("æ˜¯çš„ï¼Œä½ åˆšåˆšå­¦ä¹ äº†å¦‚ä½•å–æ¶ˆWebè¯·æ±‚ï¼ ğŸ‘")]),t._v(" "),o("h2",{attrs:{id:"ğŸ¤©è®©æˆ‘ä»¬ç”¨react-hooksåšåˆ°è¿™ä¸€ç‚¹"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¤©è®©æˆ‘ä»¬ç”¨react-hooksåšåˆ°è¿™ä¸€ç‚¹"}},[t._v("#")]),t._v(" ğŸ¤©è®©æˆ‘ä»¬ç”¨React Hooksåšåˆ°è¿™ä¸€ç‚¹ï¼")]),t._v(" "),o("p",[t._v("âŒ"),o("strong",[t._v("æ”¹é€ ä¹‹å‰")])]),t._v(" "),o("p",[t._v("ä¸‹é¢æ˜¯ä¸€ä¸ªç»„ä»¶ç¤ºä¾‹ï¼Œå®ƒè¯·æ±‚æ•°æ®å¹¶å±•ç¤ºå®ƒä»¬ã€‚")]),t._v(" "),o("p",[o("img",{attrs:{src:"https://s3.qiufeng.blue/blog/466wuql2ru1fgkrc2snx.jpeg",alt:"466wuql2ru1fgkrc2snx"}})]),t._v(" "),o("p",[t._v("å¦‚æœæˆ‘ä»¬ç¦»å¼€é¡µé¢çš„é€Ÿåº¦å¤ªå¿«è€Œå¯¼è‡´è¯·æ±‚æœªå®Œæˆï¼š"),o("strong",[t._v("MEMORY LEAK")])]),t._v(" "),o("p",[o("img",{attrs:{src:"https://s3.qiufeng.blue/blog/daavdtgn3tvfeybcf3rq.png",alt:"daavdtgn3tvfeybcf3rq"}})]),t._v(" "),o("p",[t._v("âœ… "),o("strong",[t._v("æ”¹é€ ä¹‹å")])]),t._v(" "),o("p",[t._v("æˆ‘ä»¬ä½¿ç”¨ "),o("code",[t._v("useEffect")]),t._v(" æ¥è®¢é˜…æˆ‘ä»¬çš„ "),o("code",[t._v("fetch")]),t._v(" è¯·æ±‚æ¥é¿å…å†…å­˜æ³„æ¼ã€‚ å½“ç»„ä»¶å¸è½½(unmounted)æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨"),o("code",[t._v("useEffect")]),t._v("çš„æ¸…ç†æ–¹æ³•æ¥è°ƒç”¨"),o("code",[t._v("abort()")]),t._v("ã€‚")]),t._v(" "),o("p",[o("img",{attrs:{src:"https://s3.qiufeng.blue/blog/zsr8g1ecnburui4rkje9.png",alt:"zsr8g1ecnburui4rkje9"}})]),t._v(" "),o("p",[t._v("ç°åœ¨ï¼Œä¸å†æœ‰å†…å­˜æ³„æ¼ï¼ ğŸ˜")]),t._v(" "),o("p",[o("img",{attrs:{src:"https://s3.qiufeng.blue/blog/wqa6uud2tnz90okxiy1e.gif",alt:"wqa6uud2tnz90okxiy1e"}})]),t._v(" "),o("p",[t._v("ä½ å¯ä»¥åœ¨ https://abort-with-react-hooks.vercel.app/ ä¸ŠæŸ¥çœ‹æ­¤æ¼”ç¤ºã€‚")]),t._v(" "),o("p",[t._v("å¯ä»¥åœ¨ https://github.com/hua1995116/node-demo/react-abort æŸ¥çœ‹æºç ")]),t._v(" "),o("p",[t._v("å¹²æ¯ ğŸ» ğŸ» ğŸ»")])])}),[],!1,null,null,null);e.default=r.exports}}]);